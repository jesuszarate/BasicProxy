import hashlib
import socket


def whois(hash):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("hash.cymru.com", 43))
    s.send(hash + "\r\n")

    response = ""
    while True:
        data = s.recv(4096)
        response += data
        if not data:
            break
    s.close()

    return response


def md5(fname):
    hash_md5 = hashlib.md5()
    with open(fname, "rb") as f:
        for chunk in iter(lambda: f.read(4096), b""):
            hash_md5.update(chunk)
    return hash_md5.hexdigest()

def checkBytes(chunk):
    hash_md5 = hashlib.md5()
    hash_md5.update(chunk)
    return hash_md5.hexdigest(), whois(hash_md5.hexdigest())

def check(fname):
    hash_md5 = md5(fname)
    return whois(hash_md5)




#print check('/Users/jesuszarate/SchoolSemesters/Spring2017/CS4480-Networks/pa1-BasicProxy/whoisClient/ThisIsMALWARE.exe')

#print whois('f40581e27c69d18f8c12c1297622866d')
#
#print whois('02e0b78e2876087f678f070ed60e4c30')
#
# print whois('02e0b78e2876087f678f070ed60e4c30')

